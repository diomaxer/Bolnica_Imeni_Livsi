<!DOCTYPE html>
<html lang="ru">
{% include 'head.html' %}
<body class="account-bg">
    
{% include 'menu-mobile.html' %}

{% include 'menu-main.html' %}

{% if course in permissions %}
    {% if lesson in progress %}
    <div class="lessonpage-main grid">
        <h1>Тест "{{ title }}"</h1>
        <div class="pick-lesson">
            
        </div>
        <div class="lessonpage-window grid">
            <a class="lesson-nav lesson-nav-left" href="../../content/{{ last }}">
                
            </a>
            <div class="lessonpage-content grid">
                    <script>
                      /** Simple JavaScript Quiz
                       * version 0.1.0
                       * http://journalism.berkeley.edu
                       * created by: Jeremy Rue @jrue
                       *
                       * Copyright (c) 2013 The Regents of the University of California
                       * Released under the GPL Version 2 license
                       * http://www.opensource.org/licenses/gpl-2.0.php
                       * This program is distributed in the hope that it will be useful, but
                       * WITHOUT ANY WARRANTY; without even the implied warranty of
                       * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
                       */
                  
                      var quiztitle = "Вопросы";
                  
                      /**
                      * Set the information about your questions here. The correct answer string needs to match
                      * the correct choice exactly, as it does string matching. (case sensitive)
                      *
                      */

                      quiz = []
                      {% for q in question %}
                            correct = ''
                            explanation = ''
                            image = ''
                            choises_arr = []
                            {% for a in q.answer.all %}
                              choises_arr.push('{{a}}');
                              {% if a.is_true %}
                                correct = '{{a}}'
                              {% endif %}
                            {% endfor %}
                            quiz.push({
                              "question": '{{q}}',
                              "image": '/media/{{q.question_image}}',
                              "choices": choises_arr,
                              "correct": correct,
                              "explanation": '{{q.explanation}}',
                            });
                      {% endfor %}
                  
                  
                      /******* No need to edit below this line *********/
                  var currentquestion=0,score=0,submt=true,picked;jQuery(document).ready(function(e){function h(i){return e(document.createElement("div")).text(i).html()}function b(k){if(typeof k!=="undefined"&&e.type(k)=="array"){e("#choice-block").empty();for(var j=0;j<k.length;j++){e(document.createElement("li")).addClass("choice choice-box").attr("data-index",j).text(k[j]).appendTo("#choice-block")}}}function d(){submt=true;e("#explanation").empty();e("#question").text(quiz[currentquestion]["question"]);e("#pager").text("Вопрос "+Number(currentquestion+1)+" из "+quiz.length);if(quiz[currentquestion].hasOwnProperty("image")&&quiz[currentquestion]["image"]!=""){if(e("#question-image").length==0){e(document.createElement("img")).addClass("question-image").attr("id","question-image").attr("src",quiz[currentquestion]["image"]).attr("alt",h(quiz[currentquestion]["question"])).insertAfter("#question")}else{e("#question-image").attr("src",quiz[currentquestion]["image"]).attr("alt",h(quiz[currentquestion]["question"]))}}else{e("#question-image").remove()}b(quiz[currentquestion]["choices"]);c()}function f(i){if(quiz[currentquestion]["choices"][i]==quiz[currentquestion]["correct"]){e(".choice").eq(i).css({"background-color":"#50D943"});e("#explanation").html("<strong>Правильно!</strong> "+h(quiz[currentquestion]["explanation"]));score++}else{e(".choice").eq(i).css({"background-color":"#D92623"});e("#explanation").html("<strong>Неправильно.</strong> "+h(quiz[currentquestion]["explanation"]))}currentquestion++;e("#submitbutton").html("Следующий &raquo;").on("click",function(){if(currentquestion==quiz.length){a()}else{e(this).text("Проверить").css({color:"#222"}).off("click");d()}})}function c(){e(".choice").on("mouseover",function(){e(this).css({"background-color":"#e1e1e1"})});e(".choice").on("mouseout",function(){e(this).css({"background-color":"#fff"})});e(".choice").on("click",function(){picked=e(this).attr("data-index");e(".choice").removeAttr("style").off("mouseout mouseover");e(this).css({"border-color":"#222","font-weight":700,"background-color":"#c1c1c1"});if(submt){submt=false;e("#submitbutton").css({color:"#000"}).on("click",function(){e(".choice").off("click");e(this).off("click");f(picked)})}})}function a(){e("#explanation").empty();e("#question").empty();e("#choice-block").empty();e("#submitbutton").remove();e("#question").text("У вас "+score+" из "+quiz.length+" правильных ответов.");e(document.createElement("h2")).css({"text-align":"center","font-size":"4em"}).text(Math.round(score/quiz.length*100)+"%").insertAfter("#question")}function g(){if(typeof quiztitle!=="undefined"&&e.type(quiztitle)==="string"){e(document.createElement("h1")).text(quiztitle).appendTo("#frame")}else{e(document.createElement("h1")).text("Quiz").appendTo("#frame")}if(typeof quiz!=="undefined"&&e.type(quiz)==="array"){e(document.createElement("p")).addClass("pager").attr("id","pager").text("Вопрос 1 из "+quiz.length).appendTo("#frame");e(document.createElement("h2")).addClass("question").attr("id","question").text(quiz[0]["question"]).appendTo("#frame");if(quiz[0].hasOwnProperty("image")&&quiz[0]["image"]!=""){e(document.createElement("img")).addClass("question-image").attr("id","question-image").attr("src",quiz[0]["image"]).attr("alt",h(quiz[0]["question"])).appendTo("#frame")}e(document.createElement("p")).addClass("explanation").attr("id","explanation").html("&nbsp;").appendTo("#frame");e(document.createElement("ul")).attr("id","choice-block").appendTo("#frame");b(quiz[0]["choices"]);e(document.createElement("div")).addClass("choice-box").attr("id","submitbutton").text("Проверить").css({"font-weight":700,color:"#222",padding:"30px 0"}).appendTo("#frame");c()}}g()});
                      </script>
                      <style type="text/css" media="all">
                          /*css reset */
                          article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block;} 
                          ol,ul{list-style:none;}
                          strong{font-weight:700;}
                          #frame{max-width:620px;width:auto;border:1px solid #ccc;background:#fff;padding:10px;margin:3px;}
                          p.pager{margin:5px 0 5px; font:bold 1em/1em "Helvetica Neue", Helvetica, Arial, sans-serif;color:#999;}
                          img.question-image{display:block;max-width:250px;margin:10px auto;border:1px solid #ccc;width:100%;height:auto;}
                          #choice-block{display:block;list-style:none;margin:0;padding:0;}
                          #submitbutton{background:#5a6b8c;}
                          #submitbutton:hover{background:#7b8da6;}
                          #explanation{margin:0 auto;padding:20px;width:75%;}
                          .choice-box{display:block;text-align:center;margin:8px auto;padding:10px 0;border:1px solid #666;cursor:pointer;-webkit-border-radius: 5px;-moz-border-radius: 5px;border-radius: 5px;}
                      </style>

                      <div id="frame" role="content"></div>
















                <form method="post" action="." href="../../../">{% csrf_token %}
                <button class="button-main lesson-submit">Завершить урок</button>
                </form>
            </div>

            <div class="lessonpage-window-pages">
                <p>Вы на странице <b>с тестом</b></p>
                {% for p in pages %}
                    <a href="../../content/{{ forloop.counter }}">{{ forloop.counter }}</a>
                {% endfor %}
                {% if messages %}
                    {% for message in messages %}
                    <br><a class="lesson-nav" href="../../../" style="width: 100%; height: 100%;">Вернуться к урокам</a>
                    <p{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</p>
                    {% endfor %}
                {% else %}
                <br><a class="lesson-nav" href="../../content/1" style="width: 100%; height: 100%;">В начало</a>
                {% endif %}
            </div>
        </div>
    </div>
    {% else %}
    <div class="lessonpage-main grid">
        <h1>{{ title }}</h1>
        <div class="pick-lesson">   
            <a href="../../../../" class="button-main">К выбору курсов</a>
        </div>
        <div class="lessonpage-window grid">
            <div class="lessonpage-content grid">
                <h2>Доступ закрыт</h2>
                <p>Для просмотра материалов требуется пройти предыдущий урок</p>
                <form action="../../../" method="get">
                    <button class="button-main">К выбору уроков</button>
                </form>
            </div>
        </div>
    </div>
    {% endif %}
{% else %}

<div class="lessonpage-main grid">
    <h1>{{ title }}</h1>
    <div class="pick-lesson">   
        <a href="../../../../" class="button-main">К выбору курсов</a>
    </div>
    <div class="lessonpage-window grid">
        <div class="lessonpage-content grid">
            <h2>Доступ закрыт</h2>
            <p>Для просмотра материалов требуется приобретение курса</p>
            <form action="/#courses" method="get">
                <button class="button-main">Приобрести курс</button>
            </form>
        </div>
    </div>
</div>

{% endif %}

{% include 'footer.html' %}
<!-- popup -->
{% include 'popup.html' %}
{% include 'emptytutors.html' %}

</body>
</html>
{% load static %}
{% include 'head.html' %}
{% load crispy_forms_tags %}
<body class="account-bg">
{% include 'menu-mobile.html' %}

{% include 'menu-main.html' %}

<script type="text/javascript">
(function() {
  var message = 'Вы уверены, что хотите удалить данный адрес?';
  var actions = document.getElementsByName('action_remove');
  if (actions.length) {
    actions[0].addEventListener("click", function(e) {
      if (! confirm(message)) {
        e.preventDefault();
      }
    });
  }
})();
</script>

<div class="account-main grid">
  <div class="account-window grid" style="margin: 0 auto; text-align: center;">
    {% block content %}
    <a href="/account/password/reset" class="button-main" style="font-size: 27px; text-decoration: none;">Смена пароля</a>
    <h2 style="color: #ececec;">Управление email-адресами</h2>
    {% if user.emailaddress_set.all %}
    <p style="margin-bottom: 20px;">Адреса, связанные с вашим аккаунтом:</p>

    <form action="." class="email_list" method="post">
    {% csrf_token %}
    <fieldset class="blockLabels">

    {% for emailaddress in user.emailaddress_set.all %}
    <div class="ctrlHolder">
        <label for="email_radio_{{forloop.counter}}" class="{% if emailaddress.primary %}primary_email{%endif%}">

        <input id="email_radio_{{forloop.counter}}" type="radio" name="email" {% if emailaddress.primary or user.emailaddress_set.count == 1 %}checked="checked"{%endif %} value="{{emailaddress.email}}"/>

    {{ emailaddress.email }}
        {% if emailaddress.verified %}
        <span class="verified" style="text-align: center;"> | Подтвержден</span>
        {% else %}
        <span class="unverified" style="text-align: center;"> | Не подтвержден</span>
        {% endif %}
        {% if emailaddress.primary %}
        <span class="primary" style="text-align: center;"> | Основной</span>
        {% endif %}
    </label>
    </div>
    {% endfor %}

    <div class="buttonHolder" style="text-align: center;">
        <button class="secondaryAction button-main" style="width: 290px; font-size: 16px; height: 50px; margin: 10px;" type="submit" name="action_primary" >Сделать основным</button>
        <button class="secondaryAction button-main" style="width: 290px; font-size: 16px; height: 50px; margin: 10px;" type="submit" name="action_send" >Повторное подтверждение</button>
        <button class="primaryAction button-main" style="width: 290px; font-size: 16px; height: 50px; margin: 10px;" type="submit" name="action_remove" >Удалить</button>
    </div>

    </fieldset>
    </form>
    <p>*Основной email-адрес нельзя удалить. Через него осуществляется вход на сайт</p>

    {% else %}
    <p>У Вас еще нет привязанных адресов. Пожалуйста, перейдите по ссылке подтверждения, отправленной Вам при регистрации, или укажите новый email в качестве основного</p>

    {% endif %}
    <h2 style="color: #ececec;">Добавление email</h2>
    <div class="grid" style="align-items: center; justify-items: center;">
        <form method="post" action="." class="grid" style="align-items: center; justify-items: center; width: 290px;">
            {% csrf_token %}
            {{ form|crispy }}
            <button name="action_add" type="submit" class="button-main">Добавить email</button>
        </form>
    </div>
    <p>*Для подтверждения email используйте ссылку, которая будет на него отправлена</p>
    {% endblock %}
  </div>
</div>

{% include 'footer.html' %}
<!-- popup -->
{% include 'popup.html' %}
{% include 'emptytutors.html' %}

</body>
</html>